---
tag:
  - AI_GEN

---

# å¤´æ–‡ä»¶ä¿æŠ¤æœºåˆ¶

Q:ä¸¾ä¾‹ï¼Œå¦‚æœä¸å†™å¤´æ–‡ä»¶ä¿æŠ¤ï¼Œå¯èƒ½æœ‰ä»€ä¹ˆé—®é¢˜
---
å¯èƒ½ä¼šé‡åˆ°é‡å¤å®šä¹‰é—®é¢˜ã€‚
æ¯”å¦‚foo.cppå’Œbar.cppéƒ½include foo.h. å¦‚æœå¤´æ–‡ä»¶åªæœ‰å‡½æ•°å£°æ˜ï¼Œç¼–è¯‘å™¨ä¸ä¼šæŠ¥é”™ã€‚å¦‚æœæœ‰å‡½æ•°å®šä¹‰ï¼Œæˆ–å…¨å±€å˜é‡ï¼Œå°±ä¼šè§¦å‘é‡å¤å®šä¹‰æŠ¥é”™ã€‚
```cpp
// foo.h

void printfoo(); //It' ok. å¦‚æœåªæ˜¯å‡½æ•°å£°æ˜ï¼Œæ²¡é—®é¢˜ï¼Œç¼–è¯‘å™¨è¿è¡Œé‡å¤å£°æ˜ã€‚

int g_foo; // error. å…¨å±€å˜é‡ï¼Œè§¦å‘é‡å¤å®šä¹‰æŠ¥é”™

void printbar(int bar){ std::cout < bar < std::endl; } // error. ä¼šè§¦å‘é‡å¤å®šä¹‰æŠ¥é”™
```

Q:å†™äº†å¤´æ–‡ä»¶ä¿æŠ¤å°±ä¸‡å…¨äº†å—ï¼Ÿ
---
ä¸æ˜¯ã€‚
## åªèƒ½ä¿æŠ¤ç¼–è¯‘é˜¶æ®µé‡å¤å®šä¹‰

## âœ… ä¸¾ä¸ªç»å…¸ä¾‹å­è¯´æ˜ï¼š

### ğŸš« æ²¡æœ‰å¤´æ–‡ä»¶ä¿æŠ¤ä¼šæ€æ ·ï¼Ÿ

```cpp
// A.h
struct A {
    int x;
};
```

```cpp
// B.h
#include "A.h"
#include "A.h"  // ç¬¬äºŒæ¬¡åŒ…å«ï¼

void foo();
```

```cpp
// main.cpp
#include "B.h"
```

### ğŸ’¥ ç¼–è¯‘å™¨æŠ¥é”™ï¼š

```
error: redefinition of 'struct A'
```

å› ä¸ºç¼–è¯‘å™¨çœ‹åˆ° `main.cpp` ä¸­é€šè¿‡ `B.h` ä¸¤æ¬¡åŒ…å«äº† `A.h`ï¼Œäºæ˜¯è®¤ä¸ºä½ é‡å¤å®šä¹‰äº† `A` ä¸¤æ¬¡ã€‚

---

## âœ… ç”¨ `#pragma once` å°±ä¸ä¼šæœ‰é—®é¢˜

```cpp
// A.h
#pragma once
struct A {
    int x;
};
```

`#pragma once` ä¼šå‘Šè¯‰ç¼–è¯‘å™¨ï¼š

> â€œåœ¨åŒä¸€ä¸ªç¿»è¯‘å•å…ƒï¼ˆ.cpp ç¼–è¯‘æ–‡ä»¶ï¼‰ä¸­ï¼Œè¿™ä¸ªå¤´æ–‡ä»¶åªå±•å¼€ä¸€æ¬¡ã€‚â€

æ‰€ä»¥å“ªæ€•ä½ è¿™æ ·å†™ï¼š

```cpp
#include "A.h"
#include "A.h"
#include "A.h"
```

ä¹Ÿåªä¼šç”Ÿæ•ˆä¸€æ¬¡ï¼Œå‰©ä¸‹çš„å¿½ç•¥ï¼Œä¸ä¼šé‡å¤å®šä¹‰ `struct A`ã€‚

---

## âœ… å¯¹æ¯”ï¼šç¼–è¯‘é”™è¯¯ vs é“¾æ¥é”™è¯¯

| é”™è¯¯ç±»å‹   | åŸå›                          | ä¸¾ä¾‹                                                      | `#pragma once` æ˜¯å¦èƒ½é˜²æ­¢ |
| ------ | -------------------------- | ------------------------------------------------------- | -------------------- |
| âœ… ç¼–è¯‘é”™è¯¯ | åŒä¸€ä¸ª `.cpp` ä¸­é‡å¤åŒ…å«å¤´æ–‡ä»¶        | `#include "A.h"` ä¸¤æ¬¡ â†’ ç»“æ„ä½“é‡å¤å®šä¹‰                           | âœ… èƒ½é˜²                 |
| âŒ é“¾æ¥é”™è¯¯ | ä¸åŒ `.cpp` éƒ½åŒ…å«äº†åŒä¸€ä¸ªå¤´æ–‡ä»¶ä¸­å®šä¹‰çš„å‡½æ•° | `DFS.cpp`, `main.cpp` éƒ½ include `DFS.h`ï¼Œä¸” `DFS.h` æœ‰å‡½æ•°å®šä¹‰ | âŒ ä¸èƒ½é˜²                |

---

## âœ… æ‰€ä»¥æ€»ç»“ä¸€ä¸‹ï¼š

| åŠŸèƒ½                  | `#pragma once` ä½œç”¨           |
| ------------------- | --------------------------- |
| é˜²æ­¢é‡å¤ include        | âœ… åœ¨åŒä¸€ä¸ª `.cpp` æ–‡ä»¶ä¸­åªå±•å¼€ä¸€æ¬¡å¤´æ–‡ä»¶å†…å®¹ |
| é¿å…é‡å¤å®šä¹‰ struct/class | âœ… æœ‰æ•ˆ                        |
| é¿å…é‡å¤å®šä¹‰å‡½æ•°ï¼ˆé“¾æ¥æ—¶ï¼‰       | âŒ æ— æ•ˆï¼ˆéœ€è¦ `inline` æˆ–æ‹†åˆ† .cppï¼‰  |
| æå‡å¯è¯»æ€§ / ç®€åŒ–æ¡ä»¶ç¼–è¯‘å®     | âœ… æ¨èä»£æ›¿ `#ifndef` å®ä¿æŠ¤        |

---


## é“¾æ¥é˜¶æ®µé‡å¤å®šä¹‰ä¸èƒ½é¿å…

> âš ï¸ **å³ä½¿ä½ å†™äº†å¤´æ–‡ä»¶ä¿æŠ¤ï¼Œæ¯”å¦‚ `#pragma once` æˆ– `#ifndef`ï¼Œå¦‚æœä½ åœ¨å¤´æ–‡ä»¶é‡Œå†™äº† `void DFS() { ... }` è¿™æ ·é `inline` çš„å‡½æ•°å®šä¹‰ï¼Œ**
> â— **å¤šä¸ª `.cpp` æ–‡ä»¶åŒ…å«å®ƒæ—¶ï¼Œä¾ç„¶ä¼šåœ¨é“¾æ¥é˜¶æ®µæŠ¥â€œé‡å¤å®šä¹‰â€é”™è¯¯ã€‚**

---

## ğŸ§  ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ

å¤´æ–‡ä»¶ä¿æŠ¤ï¼ˆ`#pragma once` æˆ– `#ifndef`ï¼‰çš„ä½œç”¨åªæ˜¯ï¼š

> âœ… **é˜²æ­¢åŒä¸€ä¸ª `.cpp` æ–‡ä»¶ä¸­é‡å¤å±•å¼€å¤´æ–‡ä»¶å†…å®¹ï¼ˆé¿å…ç¼–è¯‘é”™è¯¯ï¼‰**

ä½†å®ƒ**å¹¶ä¸ä¼šé˜»æ­¢**å¤´æ–‡ä»¶å†…å®¹åœ¨**å¤šä¸ª `.cpp` ç¼–è¯‘å•å…ƒä¸­åˆ†åˆ«å±•å¼€ä¸€æ¬¡**ï¼

---

### ğŸ“¦ ä¸¾ä¸ªä¾‹å­ï¼š

```cpp
// DFS.h
#pragma once

void DFS() {
    // è¿™é‡Œæ˜¯å‡½æ•°å®šä¹‰ï¼ˆä¸æ˜¯å£°æ˜ï¼‰
}
```

### ç„¶åä½ åœ¨ä¸¤ä¸ªæºæ–‡ä»¶ä¸­éƒ½ includeï¼š

```cpp
// test.cpp
#include "DFS.h"  // æ‹·è´ DFS() å®ç°è¿›æ¥

// DFS.cpp
#include "DFS.h"  // åˆæ‹·è´äº†ä¸€æ¬¡ DFS() å®ç°
```

æ¯ä¸ª `.cpp` ä¼šå•ç‹¬ç¼–è¯‘æˆä¸€ä¸ª `.o` æ–‡ä»¶ï¼Œåˆ†åˆ«éƒ½ç”Ÿæˆä¸€ä¸ªåä¸º `DFS` çš„å‡½æ•°ç¬¦å·ã€‚

> ğŸ’¥ é“¾æ¥å™¨çœ‹åˆ°æœ‰ä¸¤ä¸ª `DFS` å®šä¹‰ï¼ŒæŠ›å‡º `multiple definition of 'DFS'` é”™è¯¯ã€‚

---

## âœ… é‚£æ€ä¹ˆåŠï¼Ÿæœ‰å“ªäº›è§£å†³æ–¹æ¡ˆï¼Ÿ

| æ–¹æ³•                 | åŸç†            | å†™æ³•ç¤ºä¾‹                        | æ¨èåº¦        |
| ------------------ | ------------- | --------------------------- | ---------- |
| âœ… æŠŠå‡½æ•°å®šä¹‰ç§»åˆ° `.cpp` ä¸­ | åªç•™å£°æ˜åœ¨ `.h`    | `void DFS();` â†’ `.cpp` ä¸­å®ç°  | â­â­â­â­       |
| âœ… ä½¿ç”¨ `inline`      | é“¾æ¥å™¨å…è®¸å¤šä¸ª TU å®šä¹‰ | `inline void DFS() { ... }` | â­â­â­        |
| âœ… ä½¿ç”¨ `static`      | æ¯ä¸ª TU éƒ½ç”Ÿæˆç‹¬ç«‹å‰¯æœ¬ | `static void DFS() { ... }` | â­â­ï¼ˆå·¥å…·å‡½æ•°å¯ç”¨ï¼‰ |
| âŒ ä»€ä¹ˆéƒ½ä¸åŠ ç›´æ¥å®šä¹‰        | å¤šä¸ª TU ç”Ÿæˆç›¸åŒç¬¦å·  | ä¼šé“¾æ¥å¤±è´¥                       | ğŸš« ä¸æ¨è     |

---

## âœ… æ­£ç¡®ç¤ºèŒƒï¼š

### âœ”ï¸ æ¨èæ–¹æ¡ˆï¼šåªå£°æ˜åœ¨å¤´æ–‡ä»¶ï¼Œå®šä¹‰æ”¾ .cpp

```cpp
// DFS.h
#pragma once
void DFS();  // åªå£°æ˜
```

```cpp
// DFS.cpp
#include "DFS.h"
void DFS() {
    // å®ç°ä½“
}
```

---

### âœ”ï¸ å¯é€‰æ–¹æ¡ˆï¼ˆC++17+ï¼‰ï¼šç”¨ `inline`

```cpp
// DFS.h
#pragma once
inline void DFS() {
    // å®ç°ä½“
}
```

é€‚ç”¨äºï¼š

* è½»é‡å‡½æ•°ï¼ˆæ¯”å¦‚å·¥å…·å‡½æ•°ï¼‰
* å®šä¹‰å†™åœ¨æ¨¡æ¿ç±»ä¸­
* ä¸æƒ³æ‹† .h/.cpp æ–‡ä»¶çš„å°é¡¹ç›®

---

## âœ… æ€»ç»“åˆ¤æ–­é€»è¾‘

| ä½ å†™åœ¨å¤´æ–‡ä»¶çš„å†…å®¹                   | å¤šä¸ª .cpp å¼•ç”¨æ—¶æ˜¯å¦å®‰å…¨ï¼Ÿ | åŸå›           |
| --------------------------- | ---------------- | ----------- |
| å‡½æ•°å£°æ˜ `void foo();`          | âœ… å®‰å…¨             | ä¸ç”Ÿæˆç¬¦å·       |
| å‡½æ•°å®šä¹‰ `void foo() {}`        | âŒ ä¸å®‰å…¨            | å¤šé‡å®šä¹‰        |
| `inline void foo() {}`      | âœ… å®‰å…¨             | é“¾æ¥å™¨æ¥å—å¤šä¸ªå®šä¹‰   |
| `static void foo() {}`      | âœ… å®‰å…¨             | æ¯ä¸ª TU ç‹¬ç«‹å‰¯æœ¬  |
| ç±»å®šä¹‰ `class Foo {};`         | âœ… å®‰å…¨             | ä»…ç»“æ„å£°æ˜ï¼Œä¸ç”Ÿæˆç¬¦å· |
| `extern int x;` + `.cpp` å®šä¹‰ | âœ… å®‰å…¨             | æ­£ç¡®åˆ†ç¦»å£°æ˜ä¸å®šä¹‰   |
---



Q:inlineå¦‚ä½•è§£å†³ç¼–è¯‘é‡å¤å®šä¹‰ï¼Ÿ
---
éå¸¸å¥½ï¼Œä½ è¿™ä¸ªé—®é¢˜æ¶‰åŠ C++ ç¼–è¯‘ä¸é“¾æ¥çš„æ ¸å¿ƒæœºåˆ¶ã€‚

---

## âœ… ä¸€å¥è¯æ ¸å¿ƒè§£é‡Šï¼š

> `inline` å‡½æ•°å…è®¸åœ¨å¤šä¸ª `.cpp` æ–‡ä»¶ä¸­**é‡å¤å®šä¹‰**ï¼Œ**ä½†é“¾æ¥å™¨ä¸ä¼šæŠ¥â€œé‡å¤å®šä¹‰â€é”™è¯¯**ï¼Œå› ä¸ºæ ‡å‡†è§„å®šï¼š
> âœ… â€œ**å¤šä¸ª translation unitï¼ˆç¼–è¯‘å•å…ƒï¼‰ä¸­é‡å¤å®šä¹‰ç›¸åŒ `inline` å‡½æ•°æ˜¯åˆæ³•çš„**ï¼Œé“¾æ¥å™¨å¿…é¡»åˆå¹¶å®ƒä»¬ã€‚â€

---

## ğŸ§  å…ˆå›é¡¾ä¸ºä»€ä¹ˆæ™®é€šå‡½æ•°ä¸èƒ½é‡å¤å®šä¹‰ï¼Ÿ

### âš ï¸ æ™®é€šå‡½æ•°å®šä¹‰ï¼ˆæ²¡æœ‰ `inline`ï¼‰ï¼š

```cpp
// DFS.h
void DFS() {
    // do something
}
```

ä½ å¦‚æœåœ¨ä¸¤ä¸ª `.cpp` æ–‡ä»¶éƒ½ `#include "DFS.h"`ï¼Œé‚£ä¹ˆå°±ä¼šç”Ÿæˆä¸¤ä¸ª `DFS()` çš„å®ä½“å®šä¹‰ â†’ é“¾æ¥æ—¶æŠ¥ï¼š

```
multiple definition of 'DFS()'
```

---

## âœ… åŠ äº† `inline` ä¹‹åï¼Œè¡Œä¸ºå°±å˜äº†ï¼š

```cpp
// DFS.h
inline void DFS() {
    // do something
}
```

å³ä½¿å¤šä¸ª `.cpp` éƒ½åŒ…å«äº†è¿™ä¸ªå¤´æ–‡ä»¶ï¼Œæ¯ä¸ªç¼–è¯‘å•å…ƒéƒ½ç”Ÿæˆä¸€ä¸ª `DFS()` çš„å®šä¹‰ï¼Œä½†é“¾æ¥å™¨**è¢«æ ‡å‡†å…è®¸åˆå¹¶å®ƒä»¬ä¸ºåŒä¸€ä¸ªå‡½æ•°**ï¼Œæ‰€ä»¥ä¸ä¼šæŠ¥é”™ã€‚

è¿™å°±æ˜¯ C++ ä¸­æ‰€è°“çš„ï¼š

> âœ… â€œ**ä¸€ä¸ªç¨‹åºä¸­ï¼Œinline å‡½æ•°å¯ä»¥æœ‰å¤šä¸ª identical definitions**â€

---

## ğŸ“˜ æ¥è‡ª C++ æ ‡å‡†çš„è¯´æ˜ï¼ˆç®€åŒ–ç†è§£ï¼‰

### æ ‡å‡†åŸæ–‡ï¼ˆC++17 Â§6.4.3ï¼‰ï¼š

> If a function is declared `inline`, then it must be defined in every translation unit where it is used, and the definitions **must be identical**.
> The compiler/linker must treat them as **a single definition** (not multiple).

---

## ğŸ§ª å®éªŒç¤ºæ„

### âœ… æœ‰ `inline` ä¸ä¼šæŠ¥é”™ï¼š

```cpp
// utils.h
#pragma once
inline void hello() {
    std::cout << "Hi\n";
}
```

```cpp
// main.cpp
#include "utils.h"
```

```cpp
// other.cpp
#include "utils.h"
```

### âŒ æ²¡æœ‰ `inline` ä¼šæŠ¥é”™ï¼š

```cpp
// utils.h
#pragma once
void hello() {
    std::cout << "Hi\n";
}
```

ä¸¤ä¸ª `.cpp` éƒ½åŒ…å«è¿™ä¸ªï¼Œä¼šç”Ÿæˆä¸¤ä¸ªå‡½æ•°ä½“ â†’ é“¾æ¥æ—¶æŠ¥é”™ã€‚

---

## âœ… æ€»ç»“ï¼šä¸ºä»€ä¹ˆ `inline` èƒ½é¿å…é‡å¤å®šä¹‰ï¼Ÿ

| ç‰¹æ€§             | åŸå›                                |
| -------------- | -------------------------------- |
| **å…è®¸å¤šä¸ªå®šä¹‰**     | æ ‡å‡†è§„å®š inline å‡½æ•°å¯ä»¥åœ¨å¤šä¸ª `.cpp` ä¸­é‡å¤å®šä¹‰ |
| **ä¸ç®—é‡å¤ç¬¦å·**     | é“¾æ¥å™¨åˆå¹¶ä¸ºä¸€ä¸ªå‡½æ•°ç¬¦å·                     |
| **é€‚åˆå¤´æ–‡ä»¶å®šä¹‰**    | å¯æ”¾åœ¨ `.h` æ–‡ä»¶ä¸­ç›´æ¥å®ç°                 |
| **ä¼˜åŒ–è°ƒç”¨å¼€é”€ï¼ˆåŸä¹‰ï¼‰** | åŸå§‹ç”¨é€”æ˜¯å»ºè®®ç¼–è¯‘å™¨åšâ€œå†…è”å±•å¼€â€ä¼˜åŒ–ï¼ˆç°ä»£ç¼–è¯‘å™¨ä¸å†ä¾èµ–è¿™ä¸ªï¼‰ |

---

### âœ… å®ç”¨å»ºè®®

| ç”¨æ³•åœºæ™¯               | æ˜¯å¦å»ºè®®ç”¨ inline                 |
| ------------------ | ---------------------------- |
| å·¥å…·å‡½æ•° / å¾ˆçŸ­çš„å°å‡½æ•°      | âœ… æ¨è inline                  |
| æ¨¡æ¿å‡½æ•°ï¼ˆå¿…é¡» header å®ç°ï¼‰ | âœ… è‡ªåŠ¨ inline                  |
| æ™®é€šå‡½æ•°ï¼ˆæœ‰æ¸…æ™°åˆ†å·¥ï¼‰        | âŒ ä¸å»ºè®® inlineï¼Œæ”¾ .cpp æ›´å¥½       |
| æˆå‘˜å‡½æ•°å®šä¹‰åœ¨ç±»ä¸­          | âœ… éšå¼ inlineï¼Œä¸éœ€è¦å†å†™ inline å…³é”®è¯ |

---

## ğŸ” è¡¥å……ï¼šinline ä¸ç­‰äºâ€œä¸€å®šå†…è”â€

* `inline` çš„ä½œç”¨æ˜¯ï¼šå…è®¸å¤šå®šä¹‰ã€é¿å…é“¾æ¥å†²çªï¼›
* æ˜¯å¦çœŸæ­£**å±•å¼€æˆæ— å‡½æ•°è°ƒç”¨çš„å†…è”ä»£ç **ï¼Œç”±ç¼–è¯‘å™¨ä¼˜åŒ–å™¨å†³å®šï¼›
* æ‰€ä»¥ç°ä»£å«ä¹‰çš„ `inline` æ›´åƒæ˜¯ **â€œå…è®¸æ”¾åœ¨å¤´æ–‡ä»¶å®šä¹‰çš„å‡½æ•°â€**ã€‚

---



Q:inlineçš„é‡å¤å®šä¹‰å†…å®¹ä¸ä¸€è‡´ï¼Œæ€ä¹ˆåŠ
---
è¿™æ¶‰åŠäº† C++ ç¼–è¯‘æ¨¡å‹ä¸­ **One Definition Ruleï¼ˆODRï¼‰** çš„é«˜çº§è¯é¢˜ã€‚

---

## âœ… é—®é¢˜å¤è¿°ï¼š

> ä¸¤ä¸ªä¸åŒçš„å¤´æ–‡ä»¶é‡Œéƒ½å®šä¹‰äº†ä¸€ä¸ªåŒå `inline` å‡½æ•° `foofunc()`ï¼Œä½†å‡½æ•°ä½“å†…å®¹ä¸åŒã€‚å¤šä¸ª `.cpp` åˆ†åˆ«åŒ…å«äº†è¿™ä¸¤ä¸ªå¤´æ–‡ä»¶ã€‚
> ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

---

## â—ç»“è®ºï¼š

> ğŸ’¥ **è¿™æ˜¯è¿å C++ çš„ One Definition Rule (ODR)**
> ç¼–è¯‘å™¨å¯èƒ½ä¸ä¼šæŠ¥é”™ï¼Œä½†**é“¾æ¥å™¨è¡Œä¸ºæœªå®šä¹‰ï¼ˆUndefined Behaviorï¼‰**ï¼Œæœ‰æ—¶ä¼šæ‚„æ‚„é€šè¿‡ï¼Œæœ‰æ—¶ä¼šäº§ç”Ÿç¥ç§˜ bugã€‚

---

## ğŸ“˜ C++ æ ‡å‡†ä¸­çš„è§„å®šï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š

> å¦‚æœä¸€ä¸ª `inline` å‡½æ•°åœ¨å¤šä¸ª translation unit ä¸­å‡ºç°å¤šä¸ªå®šä¹‰ï¼Œå®ƒä»¬çš„å‡½æ•°ä½“å¿…é¡» **å®Œå…¨ç›¸åŒï¼ˆidenticalï¼‰**ï¼Œå¦åˆ™è¡Œä¸ºæ˜¯ undefinedã€‚

å‡ºå¤„ï¼ˆC++17 Â§6.4.3.4ï¼‰ï¼š

> "If the definition of a function appears in more than one translation unit, then **each definition shall be identical**, otherwise the behavior is undefined."

---

## ğŸ§ª ä¸¾ä¾‹è¯´æ˜ï¼š

### âœ… ä¾‹å­ï¼šä¸¤ä¸ªå¤´æ–‡ä»¶ä¸­å®šä¹‰äº†ä¸åŒçš„ `inline` å‡½æ•°

```cpp
// A.h
#pragma once
inline void foofunc() {
    std::cout << "From A\n";
}
```

```cpp
// B.h
#pragma once
inline void foofunc() {
    std::cout << "From B\n";
}
```

---

```cpp
// main.cpp
#include "A.h"
int main() {
    foofunc();  // è¾“å‡ºï¼Ÿ
    return 0;
}
```

```cpp
// other.cpp
#include "B.h"
void other() {
    foofunc();  // è¾“å‡ºï¼Ÿ
}
```

### ğŸ”§ ç¼–è¯‘é€šè¿‡ï¼Œä½†ç»“æœæ˜¯**æœªå®šä¹‰è¡Œä¸º**ï¼

* é“¾æ¥å™¨ä¼šåˆå¹¶å¤šä¸ª `foofunc()`ï¼Œä½†åˆ°åº•ä¿ç•™çš„æ˜¯å“ªä¸ªç‰ˆæœ¬ â†’ ä¸ç¡®å®šï¼›
* æŸäº›ç¼–è¯‘å™¨å¯èƒ½ä¿ç•™ `A.h` çš„ç‰ˆæœ¬ï¼Œæœ‰çš„å¯èƒ½æ˜¯ `B.h`ï¼›
* å¦‚æœæ‰“å¼€ä¼˜åŒ–ï¼Œå¯èƒ½æŸäº› TU ä½¿ç”¨äº† A ç‰ˆï¼ŒæŸäº›ç”¨äº† B ç‰ˆ â†’ ğŸ’¥ æ··ä¹±ï¼

---

## âš ï¸ æ›´ä¸¥é‡çš„æƒ…å†µï¼šé™æ€åº“æˆ–æ¨¡æ¿åº“

è¿™ç§å†²çªå¦‚æœå‘ç”Ÿåœ¨ï¼š

* å¤šä¸ª `.lib` / `.a` é™æ€åº“ä¹‹é—´ï¼›
* æ¨¡æ¿å‡½æ•°ä¸­ `inline` å®šä¹‰äº†ä¸åŒå†…å®¹ï¼›
  ä¼šé€ æˆï¼š
* é“¾æ¥å™¨ä¸æŠ¥é”™ï¼›
* ç¨‹åºè¿è¡ŒæœŸè¡¨ç°é”™ä¹±ï¼Œä¸”æéš¾è°ƒè¯•ã€‚

---

## âœ… å¦‚ä½•é¿å…è¿™ç§å†²çªï¼Ÿ

| åšæ³•                          | è¯´æ˜                                       |
| --------------------------- | ---------------------------------------- |
| âœ… ä¸è¦åœ¨å¤šä¸ªå¤´æ–‡ä»¶ä¸­å®šä¹‰åŒå `inline` å‡½æ•° | æœ€åŸºæœ¬åŸåˆ™                                    |
| âœ… ä½¿ç”¨å‘½åç©ºé—´éš”ç¦»                  | `namespace A { inline void foofunc(); }` |
| âœ… åªåœ¨ä¸€ä¸ª `.h` ä¸­å®šä¹‰ `inline` å®ç° | é¿å… ODR å†²çª                                |
| âœ… ä½¿ç”¨ `#include` ç»„åˆæ—¶å°å¿ƒå¤´æ–‡ä»¶å†²çª  | ç‰¹åˆ«æ˜¯ç¬¬ä¸‰æ–¹åº“                                  |
| âœ… åœ¨å¤§å‹é¡¹ç›®ä¸­ç”¨æ¨¡å—/å‘½åè§„åˆ™åŒºåˆ†å‡½æ•°å‘½å      | ä¾‹å¦‚ `Math_Foo()` vs `Render_Foo()`        |

---

## ğŸ§  æ€»ç»“

| é—®é¢˜                      | ç»“è®º                              |
| ----------------------- | ------------------------------- |
| ä¸¤ä¸ªå¤´æ–‡ä»¶ä¸­ `inline` å‡½æ•°åŒåä¸åŒä½“ | âŒ è¿å One Definition Rule        |
| æ˜¯å¦æ€»ä¼šæŠ¥é”™                  | âŒ ä¸ä¸€å®šï¼Œå¾ˆå¤šæ—¶å€™ç¼–è¯‘/é“¾æ¥éƒ½èƒ½é€šè¿‡             |
| åæœ                      | **Undefined Behavior**ï¼Œç¨‹åºè¡Œä¸ºä¸å¯é¢„æµ‹ |
| é¿å…æ–¹å¼                    | é¿å…å‘½åå†²çªï¼Œç»Ÿä¸€å‡½æ•°å®šä¹‰ä½ç½®ï¼Œæˆ–ç”¨å‘½åç©ºé—´éš”ç¦»        |




